# Qwen æ™ºèƒ½æˆ¿é—´åˆ†ææ–¹æ¡ˆ

## ğŸ“‹ ç›®æ ‡

å°†å½“å‰å†™æ­»çš„æˆ¿é—´åˆ†ææ•°æ®æ”¹ä¸ºé€šè¿‡ Qwen-VL æ¨¡å‹è¿›è¡Œæ™ºèƒ½è§£æï¼ŒåŒ…æ‹¬ï¼š
1. **æˆ¿é—´ç±»å‹è¯†åˆ«**ï¼ˆRoom Typeï¼‰- ä»å›¾ç‰‡è‡ªåŠ¨è¯†åˆ«
2. **æˆ¿é—´å°ºå¯¸ä¼°è®¡**ï¼ˆRoom Dimensionsï¼‰- ä»å›¾ç‰‡è‡ªåŠ¨ä¼°ç®—
3. **æˆ¿é—´é£æ ¼è¯†åˆ«**ï¼ˆRoom Styleï¼‰- ä»å›¾ç‰‡è‡ªåŠ¨è¯†åˆ«
4. **çœŸå®ç½®ä¿¡åº¦**ï¼ˆConfidenceï¼‰- åŸºäº AI åˆ†æç»“æœ

---

## ğŸ¯ æ–¹æ¡ˆè®¾è®¡

### 1. æ•°æ®ç»“æ„å¢å¼º

#### åç«¯æ¥å£å¢å¼º

```typescript
// å¢å¼ºåçš„ FurnitureDetectionResponse
export interface FurnitureDetectionResponse {
  success: boolean;
  detectedItems: DetectedFurnitureItem[];
  isEmpty: boolean;
  
  // æ–°å¢å­—æ®µ
  roomType?: {
    value: string; // 'living_room' | 'bedroom' | 'dining_room' | 'home_office'
    confidence: number; // 0-100
  };
  roomDimensions?: {
    length: number;
    width: number;
    height: number;
    unit: 'meters' | 'feet';
    confidence: number; // 0-100
  };
  roomStyle?: {
    value: string; // 'Modern', 'Nordic', 'Classic', 'Minimalist', etc.
    confidence: number; // 0-100
  };
  furnitureCount?: {
    value: number;
    confidence: number; // 0-100
  };
  
  // ä¿ç•™åŸæœ‰å­—æ®µï¼ˆå‘åå…¼å®¹ï¼‰
  estimatedRoomDimensions?: {
    length: number;
    width: number;
    height: number;
    unit: string;
  };
}
```

### 2. Prompt è®¾è®¡

#### ç³»ç»Ÿ Promptï¼ˆå¢å¼ºç‰ˆï¼‰

```typescript
const systemPrompt = `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å®¤å†…è®¾è®¡å¸ˆã€å®¶å…·è¯†åˆ«ä¸“å®¶å’Œæˆ¿é—´åˆ†æä¸“å®¶ã€‚è¯·å…¨é¢åˆ†æè¿™å¼ æˆ¿é—´å›¾ç‰‡ï¼Œæä¾›è¯¦ç»†çš„æˆ¿é—´ä¿¡æ¯ã€‚

**åˆ†æä»»åŠ¡ï¼š**
1. è¯†åˆ«æˆ¿é—´ç±»å‹ï¼ˆå®¢å…ã€å§å®¤ã€é¤å…ã€å®¶åº­åŠå…¬å®¤ç­‰ï¼‰
2. æ£€æµ‹æ‰€æœ‰å®¶å…·åŠå…¶ä½ç½®
3. ä¼°è®¡æˆ¿é—´å°ºå¯¸ï¼ˆé•¿åº¦ã€å®½åº¦ã€é«˜åº¦ï¼‰
4. è¯†åˆ«æˆ¿é—´è£…é¥°é£æ ¼
5. åˆ¤æ–­æˆ¿é—´æ˜¯å¦ä¸ºç©º

**æˆ¿é—´ç±»å‹è¯†åˆ«è§„åˆ™ï¼š**
- living_roomï¼ˆå®¢å…ï¼‰ï¼šé€šå¸¸æœ‰æ²™å‘ã€èŒ¶å‡ ã€ç”µè§†ã€ä¼‘é—²åŒºåŸŸ
- bedroomï¼ˆå§å®¤ï¼‰ï¼šé€šå¸¸æœ‰åºŠã€è¡£æŸœã€åºŠå¤´æŸœ
- dining_roomï¼ˆé¤å…ï¼‰ï¼šé€šå¸¸æœ‰é¤æ¡Œã€é¤æ¤…ã€é¤è¾¹æŸœ
- home_officeï¼ˆå®¶åº­åŠå…¬å®¤ï¼‰ï¼šé€šå¸¸æœ‰ä¹¦æ¡Œã€åŠå…¬æ¤…ã€ä¹¦æ¶ã€ç”µè„‘è®¾å¤‡

**æˆ¿é—´é£æ ¼è¯†åˆ«è§„åˆ™ï¼š**
- Modernï¼ˆç°ä»£ï¼‰ï¼šç®€æ´çº¿æ¡ã€ä¸­æ€§è‰²è°ƒã€é‡‘å±/ç»ç’ƒæè´¨
- Nordicï¼ˆåŒ—æ¬§ï¼‰ï¼šæµ…è‰²è°ƒã€æœ¨è´¨å…ƒç´ ã€ç®€çº¦è®¾è®¡ã€è‡ªç„¶æè´¨
- Classicï¼ˆç»å…¸ï¼‰ï¼šä¼ ç»Ÿå®¶å…·ã€æ·±è‰²æœ¨æã€è£…é¥°æ€§å…ƒç´ 
- Minimalistï¼ˆæç®€ï¼‰ï¼šæç®€è®¾è®¡ã€å¤§é‡ç•™ç™½ã€åŠŸèƒ½æ€§ä¼˜å…ˆ
- Industrialï¼ˆå·¥ä¸šï¼‰ï¼šè£¸éœ²ç –å¢™ã€é‡‘å±å…ƒç´ ã€å¤å¤é£æ ¼
- Contemporaryï¼ˆå½“ä»£ï¼‰ï¼šç°ä»£ä¸ä¼ ç»Ÿçš„èåˆã€ä¸­æ€§è‰²è°ƒ
- Traditionalï¼ˆä¼ ç»Ÿï¼‰ï¼šç»å…¸è£…é¥°ã€å¯¹ç§°å¸ƒå±€ã€ä¸°å¯Œç»†èŠ‚
- Bohemianï¼ˆæ³¢è¥¿ç±³äºšï¼‰ï¼šè‰²å½©ä¸°å¯Œã€æ··æ­é£æ ¼ã€è‰ºæœ¯è£…é¥°

**å°ºå¯¸ä¼°è®¡æ–¹æ³•ï¼š**
- å‚è€ƒå›¾ç‰‡ä¸­çš„å·²çŸ¥ç‰©ä½“ï¼ˆå¦‚é—¨ã€çª—æˆ·ã€æ ‡å‡†å®¶å…·ï¼‰è¿›è¡Œæ¯”ä¾‹ä¼°ç®—
- ä½¿ç”¨é€è§†åŸç†å’Œè§†è§‰æ¯”ä¾‹
- å¦‚æœæ— æ³•å‡†ç¡®ä¼°è®¡ï¼Œæä¾›åˆç†èŒƒå›´

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¿”å›ç»“æœï¼Œç¡®ä¿æ‰€æœ‰å­—æ®µéƒ½å­˜åœ¨ï¼š`;
```

#### ç”¨æˆ· Promptï¼ˆå¢å¼ºç‰ˆï¼‰

```typescript
const userPrompt = `è¯·å…¨é¢åˆ†æè¿™å¼ æˆ¿é—´å›¾ç‰‡ï¼Œæä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **æˆ¿é—´ç±»å‹**ï¼šè¯†åˆ«è¿™æ˜¯å“ªç§ç±»å‹çš„æˆ¿é—´ï¼ˆliving_room/bedroom/dining_room/home_officeï¼‰
2. **å®¶å…·æ£€æµ‹**ï¼šåˆ—å‡ºæ‰€æœ‰æ£€æµ‹åˆ°çš„å®¶å…·ï¼ŒåŒ…æ‹¬ä½ç½®å’Œç½®ä¿¡åº¦
3. **æˆ¿é—´å°ºå¯¸**ï¼šä¼°è®¡æˆ¿é—´çš„é•¿ã€å®½ã€é«˜ï¼ˆå•ä½ï¼šç±³æˆ–è‹±å°ºï¼‰
4. **æˆ¿é—´é£æ ¼**ï¼šè¯†åˆ«æˆ¿é—´çš„è£…é¥°é£æ ¼
5. **æ˜¯å¦ä¸ºç©º**ï¼šåˆ¤æ–­æˆ¿é—´æ˜¯å¦ä¸ºç©ºæˆ¿é—´

${roomDimensions ? `ç”¨æˆ·æä¾›çš„æˆ¿é—´å°ºå¯¸å‚è€ƒï¼š${roomDimensions.length} Ã— ${roomDimensions.width} Ã— ${roomDimensions.height} ${roomDimensions.unit}` : ''}

è¯·è¿”å›å®Œæ•´çš„JSONç»“æœï¼ŒåŒ…å«æ‰€æœ‰åˆ†æä¿¡æ¯ã€‚`;
```

#### å®Œæ•´ Prompt æ¨¡æ¿

```typescript
const ENHANCED_SYSTEM_PROMPT = `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å®¤å†…è®¾è®¡å¸ˆã€å®¶å…·è¯†åˆ«ä¸“å®¶å’Œæˆ¿é—´åˆ†æä¸“å®¶ã€‚è¯·å…¨é¢åˆ†æè¿™å¼ æˆ¿é—´å›¾ç‰‡ï¼Œæä¾›è¯¦ç»†çš„æˆ¿é—´ä¿¡æ¯ã€‚

**ä½ çš„ä»»åŠ¡ï¼š**
1. è¯†åˆ«æˆ¿é—´ç±»å‹ï¼ˆä»ä»¥ä¸‹é€‰é¡¹ä¸­é€‰æ‹©ï¼šliving_room, bedroom, dining_room, home_officeï¼‰
2. æ£€æµ‹æ‰€æœ‰å®¶å…·åŠå…¶ä½ç½®ï¼ˆbounding boxï¼‰
3. ä¼°è®¡æˆ¿é—´å°ºå¯¸ï¼ˆé•¿åº¦ã€å®½åº¦ã€é«˜åº¦ï¼Œå•ä½ï¼šç±³æˆ–è‹±å°ºï¼‰
4. è¯†åˆ«æˆ¿é—´è£…é¥°é£æ ¼ï¼ˆModern, Nordic, Classic, Minimalist, Industrial, Contemporary, Traditional, Bohemianç­‰ï¼‰
5. åˆ¤æ–­æˆ¿é—´æ˜¯å¦ä¸ºç©º
6. ç»Ÿè®¡å®¶å…·æ•°é‡

**æˆ¿é—´ç±»å‹è¯†åˆ«æŒ‡å—ï¼š**
- **living_roomï¼ˆå®¢å…ï¼‰**ï¼šé€šå¸¸æœ‰æ²™å‘ã€èŒ¶å‡ ã€ç”µè§†ã€ä¼‘é—²åŒºåŸŸã€åœ°æ¯¯
- **bedroomï¼ˆå§å®¤ï¼‰**ï¼šé€šå¸¸æœ‰åºŠã€è¡£æŸœã€åºŠå¤´æŸœã€æ¢³å¦†å°
- **dining_roomï¼ˆé¤å…ï¼‰**ï¼šé€šå¸¸æœ‰é¤æ¡Œã€é¤æ¤…ã€é¤è¾¹æŸœã€åŠç¯
- **home_officeï¼ˆå®¶åº­åŠå…¬å®¤ï¼‰**ï¼šé€šå¸¸æœ‰ä¹¦æ¡Œã€åŠå…¬æ¤…ã€ä¹¦æ¶ã€ç”µè„‘è®¾å¤‡ã€æ–‡ä»¶æŸœ

**æˆ¿é—´é£æ ¼è¯†åˆ«æŒ‡å—ï¼š**
- **Modernï¼ˆç°ä»£ï¼‰**ï¼šç®€æ´çº¿æ¡ã€ä¸­æ€§è‰²è°ƒï¼ˆé»‘ç™½ç°ï¼‰ã€é‡‘å±/ç»ç’ƒæè´¨ã€å‡ ä½•å½¢çŠ¶
- **Nordicï¼ˆåŒ—æ¬§ï¼‰**ï¼šæµ…è‰²è°ƒï¼ˆç™½è‰²ã€æµ…ç°ã€ç±³è‰²ï¼‰ã€æœ¨è´¨å…ƒç´ ã€ç®€çº¦è®¾è®¡ã€è‡ªç„¶æè´¨ã€æ¤ç‰©è£…é¥°
- **Classicï¼ˆç»å…¸ï¼‰**ï¼šä¼ ç»Ÿå®¶å…·ã€æ·±è‰²æœ¨æã€è£…é¥°æ€§å…ƒç´ ã€å¯¹ç§°å¸ƒå±€ã€ä¸°å¯Œç»†èŠ‚
- **Minimalistï¼ˆæç®€ï¼‰**ï¼šæç®€è®¾è®¡ã€å¤§é‡ç•™ç™½ã€åŠŸèƒ½æ€§ä¼˜å…ˆã€ä¸­æ€§è‰²è°ƒã€å°‘è£…é¥°
- **Industrialï¼ˆå·¥ä¸šï¼‰**ï¼šè£¸éœ²ç –å¢™ã€é‡‘å±å…ƒç´ ã€å¤å¤é£æ ¼ã€æ·±è‰²è°ƒã€ç²—çŠ·æè´¨
- **Contemporaryï¼ˆå½“ä»£ï¼‰**ï¼šç°ä»£ä¸ä¼ ç»Ÿçš„èåˆã€ä¸­æ€§è‰²è°ƒã€èˆ’é€‚æ„Ÿã€å¹³è¡¡è®¾è®¡
- **Traditionalï¼ˆä¼ ç»Ÿï¼‰**ï¼šç»å…¸è£…é¥°ã€å¯¹ç§°å¸ƒå±€ã€ä¸°å¯Œç»†èŠ‚ã€æš–è‰²è°ƒã€è£…é¥°æ€§å…ƒç´ 
- **Bohemianï¼ˆæ³¢è¥¿ç±³äºšï¼‰**ï¼šè‰²å½©ä¸°å¯Œã€æ··æ­é£æ ¼ã€è‰ºæœ¯è£…é¥°ã€è‡ªç„¶å…ƒç´ ã€ä¸ªæ€§åŒ–

**å°ºå¯¸ä¼°è®¡æ–¹æ³•ï¼š**
- å‚è€ƒå›¾ç‰‡ä¸­çš„å·²çŸ¥ç‰©ä½“ï¼ˆå¦‚æ ‡å‡†é—¨é«˜çº¦2ç±³ã€çª—æˆ·ã€æ ‡å‡†å®¶å…·å°ºå¯¸ï¼‰è¿›è¡Œæ¯”ä¾‹ä¼°ç®—
- ä½¿ç”¨é€è§†åŸç†å’Œè§†è§‰æ¯”ä¾‹å…³ç³»
- å¦‚æœæ— æ³•å‡†ç¡®ä¼°è®¡ï¼Œæä¾›åˆç†èŒƒå›´ï¼ˆå¦‚ï¼šé•¿åº¦ 3-5ç±³ï¼‰
- é«˜åº¦é€šå¸¸ä¸º 2.4-3.0ç±³ï¼ˆæ ‡å‡†å±‚é«˜ï¼‰

**ç½®ä¿¡åº¦è¯„ä¼°ï¼š**
- å¯¹äºæ¯ä¸ªåˆ†æç»“æœï¼Œæä¾›0-100çš„ç½®ä¿¡åº¦åˆ†æ•°
- ç½®ä¿¡åº¦åŸºäºï¼šå›¾ç‰‡æ¸…æ™°åº¦ã€ç‰¹å¾æ˜æ˜¾ç¨‹åº¦ã€åˆ†æç¡®å®šæ€§

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¿”å›ç»“æœï¼Œç¡®ä¿æ‰€æœ‰å­—æ®µéƒ½å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®ï¼š`;

const ENHANCED_USER_PROMPT = (roomDimensions?: any) => `è¯·å…¨é¢åˆ†æè¿™å¼ æˆ¿é—´å›¾ç‰‡ï¼Œæä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **æˆ¿é—´ç±»å‹è¯†åˆ«**ï¼šè¯†åˆ«è¿™æ˜¯å“ªç§ç±»å‹çš„æˆ¿é—´ï¼Œä» living_room, bedroom, dining_room, home_office ä¸­é€‰æ‹©æœ€åŒ¹é…çš„
2. **å®¶å…·æ£€æµ‹**ï¼šåˆ—å‡ºæ‰€æœ‰æ£€æµ‹åˆ°çš„å®¶å…·ï¼ŒåŒ…æ‹¬ï¼š
   - å®¶å…·ç±»å‹ï¼ˆå¦‚ï¼šæ²™å‘ã€æ¡Œå­ã€æ¤…å­ã€åºŠç­‰ï¼‰
   - ä½ç½®ï¼ˆbounding boxï¼Œä½¿ç”¨0-100çš„ç™¾åˆ†æ¯”åæ ‡ï¼‰
   - ç½®ä¿¡åº¦ï¼ˆ0-1ä¹‹é—´çš„å°æ•°ï¼‰
3. **æˆ¿é—´å°ºå¯¸ä¼°è®¡**ï¼šä¼°è®¡æˆ¿é—´çš„é•¿ã€å®½ã€é«˜ï¼ˆå•ä½ï¼šç±³æˆ–è‹±å°ºï¼‰
4. **æˆ¿é—´é£æ ¼è¯†åˆ«**ï¼šè¯†åˆ«æˆ¿é—´çš„è£…é¥°é£æ ¼ï¼ˆModern, Nordic, Classic, Minimalistç­‰ï¼‰
5. **æ˜¯å¦ä¸ºç©º**ï¼šåˆ¤æ–­æˆ¿é—´æ˜¯å¦ä¸ºç©ºæˆ¿é—´
6. **å®¶å…·æ•°é‡**ï¼šç»Ÿè®¡æ£€æµ‹åˆ°çš„å®¶å…·æ€»æ•°

${roomDimensions ? `\nç”¨æˆ·æä¾›çš„æˆ¿é—´å°ºå¯¸å‚è€ƒï¼š${roomDimensions.length} Ã— ${roomDimensions.width} Ã— ${roomDimensions.height} ${roomDimensions.unit}\nï¼ˆä½ å¯ä»¥å‚è€ƒè¿™ä¸ªä¿¡æ¯ï¼Œä½†ä¸»è¦åŸºäºå›¾ç‰‡åˆ†æï¼‰` : ''}

è¯·è¿”å›å®Œæ•´çš„JSONç»“æœï¼ŒåŒ…å«æ‰€æœ‰åˆ†æä¿¡æ¯å’Œç½®ä¿¡åº¦ã€‚`;
```

### 3. JSON è¿”å›æ ¼å¼

```json
{
  "isEmpty": false,
  "roomType": {
    "value": "living_room",
    "confidence": 92
  },
  "roomDimensions": {
    "length": 4.5,
    "width": 3.8,
    "height": 2.7,
    "unit": "meters",
    "confidence": 75
  },
  "roomStyle": {
    "value": "Modern",
    "confidence": 88
  },
  "detectedItems": [
    {
      "itemId": "item_1",
      "furnitureType": "sofa",
      "boundingBox": {
        "x": 15,
        "y": 30,
        "width": 40,
        "height": 25
      },
      "confidence": 0.92
    },
    {
      "itemId": "item_2",
      "furnitureType": "coffee_table",
      "boundingBox": {
        "x": 25,
        "y": 50,
        "width": 20,
        "height": 15
      },
      "confidence": 0.85
    }
  ],
  "furnitureCount": {
    "value": 2,
    "confidence": 90
  }
}
```

---

## ğŸ”§ å®ç°æ­¥éª¤

### Step 1: æ›´æ–°åç«¯æ¥å£å®šä¹‰

**æ–‡ä»¶**: `construction/unit_2_ai_service/src/services/ImageProcessingService.ts`

1. æ›´æ–° `FurnitureDetectionResponse` æ¥å£
2. æ›´æ–° `detectFurnitureWithAI` æ–¹æ³•
3. æ›´æ–° prompt
4. æ›´æ–° JSON è§£æé€»è¾‘

### Step 2: æ›´æ–°å‰ç«¯ç±»å‹å®šä¹‰

**æ–‡ä»¶**: `construction/unit_1_frontend_application/src/services/aiApi.ts`

1. æ›´æ–° `DetectionResponse` æ¥å£
2. ç¡®ä¿ç±»å‹å…¼å®¹

### Step 3: æ›´æ–°å‰ç«¯æ˜¾ç¤ºé€»è¾‘

**æ–‡ä»¶**: `construction/unit_1_frontend_application/src/components/steps/RoomSetupStep.tsx`

1. ä½¿ç”¨ AI è¿”å›çš„æˆ¿é—´ç±»å‹ï¼ˆè€Œä¸æ˜¯ç”¨æˆ·é€‰æ‹©ï¼‰
2. ä½¿ç”¨ AI è¿”å›çš„æˆ¿é—´å°ºå¯¸ï¼ˆè€Œä¸æ˜¯ç”¨æˆ·é€‰æ‹©ï¼‰
3. ä½¿ç”¨ AI è¿”å›çš„æˆ¿é—´é£æ ¼ï¼ˆè€Œä¸æ˜¯å†™æ­»çš„å­—ç¬¦ä¸²ï¼‰
4. ä½¿ç”¨ AI è¿”å›çš„çœŸå®ç½®ä¿¡åº¦ï¼ˆè€Œä¸æ˜¯å†™æ­»çš„å€¼ï¼‰

### Step 4: å¤„ç†è¾¹ç•Œæƒ…å†µ

1. **AI åˆ†æå¤±è´¥**ï¼šå›é€€åˆ°ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©
2. **ç½®ä¿¡åº¦è¿‡ä½**ï¼šæç¤ºç”¨æˆ·ç¡®è®¤æˆ–æ‰‹åŠ¨è°ƒæ•´
3. **æˆ¿é—´ç±»å‹ä¸åŒ¹é…**ï¼šå…è®¸ç”¨æˆ·è¦†ç›– AI ç»“æœ

---

## ğŸ“ Prompt å®Œæ•´ç‰ˆæœ¬

```typescript
const COMPLETE_SYSTEM_PROMPT = `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å®¤å†…è®¾è®¡å¸ˆã€å®¶å…·è¯†åˆ«ä¸“å®¶å’Œæˆ¿é—´åˆ†æä¸“å®¶ã€‚è¯·å…¨é¢åˆ†æè¿™å¼ æˆ¿é—´å›¾ç‰‡ï¼Œæä¾›è¯¦ç»†çš„æˆ¿é—´ä¿¡æ¯ã€‚

**ä½ çš„æ ¸å¿ƒä»»åŠ¡ï¼š**
1. è¯†åˆ«æˆ¿é—´ç±»å‹ï¼ˆliving_room/bedroom/dining_room/home_officeï¼‰
2. æ£€æµ‹æ‰€æœ‰å®¶å…·åŠå…¶ç²¾ç¡®ä½ç½®
3. ä¼°è®¡æˆ¿é—´å°ºå¯¸ï¼ˆé•¿Ã—å®½Ã—é«˜ï¼‰
4. è¯†åˆ«æˆ¿é—´è£…é¥°é£æ ¼
5. åˆ¤æ–­æˆ¿é—´æ˜¯å¦ä¸ºç©º
6. æä¾›æ¯ä¸ªåˆ†æç»“æœçš„ç½®ä¿¡åº¦

**æˆ¿é—´ç±»å‹è¯†åˆ«æ ‡å‡†ï¼š**
- **living_roomï¼ˆå®¢å…ï¼‰**ï¼šä¸»è¦ç‰¹å¾åŒ…æ‹¬æ²™å‘ã€èŒ¶å‡ ã€ç”µè§†ã€ä¼‘é—²åŒºåŸŸã€åœ°æ¯¯ã€ä¹¦æ¶ç­‰ã€‚ç©ºé—´é€šå¸¸è¾ƒå¤§ï¼Œç”¨äºä¼šå®¢å’Œä¼‘é—²ã€‚
- **bedroomï¼ˆå§å®¤ï¼‰**ï¼šä¸»è¦ç‰¹å¾åŒ…æ‹¬åºŠã€è¡£æŸœã€åºŠå¤´æŸœã€æ¢³å¦†å°ã€çª—å¸˜ç­‰ã€‚ç©ºé—´ç›¸å¯¹ç§å¯†ï¼Œç”¨äºä¼‘æ¯ã€‚
- **dining_roomï¼ˆé¤å…ï¼‰**ï¼šä¸»è¦ç‰¹å¾åŒ…æ‹¬é¤æ¡Œã€é¤æ¤…ã€é¤è¾¹æŸœã€åŠç¯ã€é¤å…·æŸœç­‰ã€‚ç©ºé—´ç”¨äºç”¨é¤ã€‚
- **home_officeï¼ˆå®¶åº­åŠå…¬å®¤ï¼‰**ï¼šä¸»è¦ç‰¹å¾åŒ…æ‹¬ä¹¦æ¡Œã€åŠå…¬æ¤…ã€ä¹¦æ¶ã€ç”µè„‘è®¾å¤‡ã€æ–‡ä»¶æŸœã€å°ç¯ç­‰ã€‚ç©ºé—´ç”¨äºå·¥ä½œã€‚

**æˆ¿é—´é£æ ¼è¯†åˆ«æ ‡å‡†ï¼š**
- **Modernï¼ˆç°ä»£ï¼‰**ï¼šç®€æ´çº¿æ¡ã€ä¸­æ€§è‰²è°ƒï¼ˆé»‘ç™½ç°ä¸ºä¸»ï¼‰ã€é‡‘å±/ç»ç’ƒæè´¨ã€å‡ ä½•å½¢çŠ¶ã€åŠŸèƒ½æ€§è®¾è®¡
- **Nordicï¼ˆåŒ—æ¬§ï¼‰**ï¼šæµ…è‰²è°ƒï¼ˆç™½è‰²ã€æµ…ç°ã€ç±³è‰²ï¼‰ã€å¤§é‡æœ¨è´¨å…ƒç´ ã€ç®€çº¦è®¾è®¡ã€è‡ªç„¶æè´¨ã€ç»¿æ¤è£…é¥°ã€èˆ’é€‚æ„Ÿ
- **Classicï¼ˆç»å…¸ï¼‰**ï¼šä¼ ç»Ÿå®¶å…·ã€æ·±è‰²æœ¨æã€è£…é¥°æ€§å…ƒç´ ã€å¯¹ç§°å¸ƒå±€ã€ä¸°å¯Œç»†èŠ‚ã€æš–è‰²è°ƒ
- **Minimalistï¼ˆæç®€ï¼‰**ï¼šæç®€è®¾è®¡ã€å¤§é‡ç•™ç™½ã€åŠŸèƒ½æ€§ä¼˜å…ˆã€ä¸­æ€§è‰²è°ƒã€å°‘è£…é¥°ã€æ•´æ´
- **Industrialï¼ˆå·¥ä¸šï¼‰**ï¼šè£¸éœ²ç –å¢™ã€é‡‘å±å…ƒç´ ã€å¤å¤é£æ ¼ã€æ·±è‰²è°ƒã€ç²—çŠ·æè´¨ã€ç®¡é“å¤–éœ²
- **Contemporaryï¼ˆå½“ä»£ï¼‰**ï¼šç°ä»£ä¸ä¼ ç»Ÿçš„èåˆã€ä¸­æ€§è‰²è°ƒã€èˆ’é€‚æ„Ÿã€å¹³è¡¡è®¾è®¡ã€ä¸ªæ€§åŒ–
- **Traditionalï¼ˆä¼ ç»Ÿï¼‰**ï¼šç»å…¸è£…é¥°ã€å¯¹ç§°å¸ƒå±€ã€ä¸°å¯Œç»†èŠ‚ã€æš–è‰²è°ƒã€è£…é¥°æ€§å…ƒç´ ã€æ­£å¼æ„Ÿ
- **Bohemianï¼ˆæ³¢è¥¿ç±³äºšï¼‰**ï¼šè‰²å½©ä¸°å¯Œã€æ··æ­é£æ ¼ã€è‰ºæœ¯è£…é¥°ã€è‡ªç„¶å…ƒç´ ã€ä¸ªæ€§åŒ–ã€è‡ªç”±æ„Ÿ

**å°ºå¯¸ä¼°è®¡æ–¹æ³•ï¼š**
1. å‚è€ƒæ ‡å‡†ç‰©ä½“ï¼šé—¨é«˜çº¦2ç±³ï¼Œçª—æˆ·å®½åº¦çº¦1-1.5ç±³ï¼Œæ ‡å‡†æ²™å‘é•¿åº¦çº¦2-3ç±³
2. ä½¿ç”¨é€è§†åŸç†ï¼šæ ¹æ®å›¾ç‰‡ä¸­çš„é€è§†å…³ç³»ä¼°ç®—å®é™…å°ºå¯¸
3. å®¶å…·æ¯”ä¾‹ï¼šæ ¹æ®å·²çŸ¥å®¶å…·å°ºå¯¸æ¨ç®—æˆ¿é—´å¤§å°
4. å¦‚æœæ— æ³•å‡†ç¡®ä¼°è®¡ï¼Œæä¾›åˆç†èŒƒå›´ï¼ˆå¦‚ï¼šé•¿åº¦ 3-5ç±³ï¼‰

**ç½®ä¿¡åº¦è¯„ä¼°æ ‡å‡†ï¼š**
- 90-100ï¼šéå¸¸ç¡®å®šï¼Œç‰¹å¾éå¸¸æ˜æ˜¾
- 70-89ï¼šæ¯”è¾ƒç¡®å®šï¼Œç‰¹å¾è¾ƒä¸ºæ˜æ˜¾
- 50-69ï¼šä¸€èˆ¬ç¡®å®šï¼Œæœ‰ä¸€å®šç‰¹å¾ä½†ä¸å¤Ÿæ˜æ˜¾
- 30-49ï¼šä¸å¤ªç¡®å®šï¼Œç‰¹å¾ä¸æ˜æ˜¾
- 0-29ï¼šéå¸¸ä¸ç¡®å®šï¼Œå‡ ä¹æ— æ³•åˆ¤æ–­

**è¾“å‡ºè¦æ±‚ï¼š**
- å¿…é¡»è¿”å›æœ‰æ•ˆçš„JSONæ ¼å¼
- æ‰€æœ‰å­—æ®µéƒ½å¿…é¡»å­˜åœ¨
- ç½®ä¿¡åº¦ä¸º0-100çš„æ•´æ•°
- å®¶å…·bounding boxåæ ‡ä¸º0-100çš„ç™¾åˆ†æ¯”
- å°ºå¯¸å•ä½ç»Ÿä¸€ï¼ˆç±³æˆ–è‹±å°ºï¼‰

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¿”å›ç»“æœï¼š`;

const COMPLETE_USER_PROMPT = (roomDimensions?: any) => {
  let prompt = `è¯·å…¨é¢åˆ†æè¿™å¼ æˆ¿é—´å›¾ç‰‡ï¼Œæä¾›ä»¥ä¸‹å®Œæ•´ä¿¡æ¯ï¼š

1. **æˆ¿é—´ç±»å‹**ï¼šä» living_room, bedroom, dining_room, home_office ä¸­é€‰æ‹©æœ€åŒ¹é…çš„ç±»å‹
2. **å®¶å…·æ£€æµ‹**ï¼šåˆ—å‡ºæ‰€æœ‰æ£€æµ‹åˆ°çš„å®¶å…·ï¼ŒåŒ…æ‹¬ç±»å‹ã€ä½ç½®ï¼ˆbounding boxï¼‰ã€ç½®ä¿¡åº¦
3. **æˆ¿é—´å°ºå¯¸**ï¼šä¼°è®¡æˆ¿é—´çš„é•¿ã€å®½ã€é«˜ï¼ˆå•ä½ï¼šç±³æˆ–è‹±å°ºï¼‰
4. **æˆ¿é—´é£æ ¼**ï¼šè¯†åˆ«è£…é¥°é£æ ¼ï¼ˆModern, Nordic, Classic, Minimalist, Industrial, Contemporary, Traditional, Bohemianç­‰ï¼‰
5. **æ˜¯å¦ä¸ºç©º**ï¼šåˆ¤æ–­æˆ¿é—´æ˜¯å¦ä¸ºç©ºæˆ¿é—´
6. **å®¶å…·æ•°é‡**ï¼šç»Ÿè®¡æ£€æµ‹åˆ°çš„å®¶å…·æ€»æ•°

`;

  if (roomDimensions) {
    prompt += `\nç”¨æˆ·æä¾›çš„æˆ¿é—´å°ºå¯¸å‚è€ƒï¼š${roomDimensions.length} Ã— ${roomDimensions.width} Ã— ${roomDimensions.height} ${roomDimensions.unit}\n`;
    prompt += `ï¼ˆä½ å¯ä»¥å‚è€ƒè¿™ä¸ªä¿¡æ¯ï¼Œä½†ä¸»è¦åŸºäºå›¾ç‰‡çš„è§†è§‰åˆ†æï¼‰\n`;
  }

  prompt += `\nè¯·è¿”å›å®Œæ•´çš„JSONç»“æœï¼ŒåŒ…å«æ‰€æœ‰åˆ†æä¿¡æ¯å’Œç½®ä¿¡åº¦ã€‚ç¡®ä¿JSONæ ¼å¼æ­£ç¡®ï¼Œå¯ä»¥ç›´æ¥è§£æã€‚`;

  return prompt;
};
```

---

## ğŸ¨ å‰ç«¯æ˜¾ç¤ºé€»è¾‘æ›´æ–°

### æ›´æ–° RoomSetupStep.tsx

```typescript
// å¤„ç†æ£€æµ‹ç»“æœ
const data = {
  roomType: detectionResult.roomType?.value || roomType, // ä¼˜å…ˆä½¿ç”¨AIç»“æœ
  dimensions: detectionResult.roomDimensions 
    ? `${detectionResult.roomDimensions.length} Ã— ${detectionResult.roomDimensions.width}`
    : `${dimensions.length}' Ã— ${dimensions.width}'`,
  furniture: detectionResult.detectedItems.map(item => item.furnitureType),
  style: detectionResult.roomStyle?.value || 'Analyzing...',
  confidence: detectionResult.roomType?.confidence || 0, // ä½¿ç”¨çœŸå®ç½®ä¿¡åº¦
  isEmpty: detectionResult.isEmpty,
  detectedItems: detectionResult.detectedItems,
  
  // æ–°å¢ï¼šå„é¡¹çš„ç½®ä¿¡åº¦
  roomTypeConfidence: detectionResult.roomType?.confidence || 0,
  dimensionsConfidence: detectionResult.roomDimensions?.confidence || 0,
  styleConfidence: detectionResult.roomStyle?.confidence || 0,
  furnitureCountConfidence: detectionResult.furnitureCount?.confidence || 0,
};
```

### æ›´æ–°æ˜¾ç¤ºç»„ä»¶

```typescript
<AIDetection 
  icon={<HomeIcon />} 
  label="Type" 
  value={roomData.roomType} 
  confidence={roomData.roomTypeConfidence || roomData.confidence} 
/>
<AIDetection 
  icon={<StraightenIcon />} 
  label="Size" 
  value={roomData.dimensions} 
  confidence={roomData.dimensionsConfidence || 92} 
/>
<AIDetection 
  icon={<ChairIcon />} 
  label="Items" 
  value={`${roomData.furniture.length} detected`} 
  confidence={roomData.furnitureCountConfidence || 88} 
/>
<AIDetection 
  icon={<PaletteIcon />} 
  label="Style" 
  value={roomData.style} 
  confidence={roomData.styleConfidence || 90} 
/>
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹**ï¼šä¿ç•™åŸæœ‰å­—æ®µï¼Œæ–°å¢å­—æ®µä¸ºå¯é€‰
2. **é”™è¯¯å¤„ç†**ï¼šå¦‚æœAIåˆ†æå¤±è´¥ï¼Œå›é€€åˆ°ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©
3. **ç½®ä¿¡åº¦é˜ˆå€¼**ï¼šå¦‚æœç½®ä¿¡åº¦è¿‡ä½ï¼ˆ<50ï¼‰ï¼Œæç¤ºç”¨æˆ·ç¡®è®¤
4. **å•ä½è½¬æ¢**ï¼šç¡®ä¿å°ºå¯¸å•ä½ç»Ÿä¸€ï¼ˆå‰ç«¯å¯èƒ½éœ€è¦è½¬æ¢ï¼‰
5. **Promptä¼˜åŒ–**ï¼šæ ¹æ®å®é™…æ•ˆæœæŒç»­ä¼˜åŒ–prompt

---

## ğŸ“Š æµ‹è¯•ç”¨ä¾‹

1. **å®¢å…å›¾ç‰‡**ï¼šåº”è¯†åˆ«ä¸º living_roomï¼Œé£æ ¼ä¸º Modern/Nordic
2. **å§å®¤å›¾ç‰‡**ï¼šåº”è¯†åˆ«ä¸º bedroomï¼Œæ£€æµ‹åˆ°åºŠã€è¡£æŸœç­‰
3. **ç©ºæˆ¿é—´**ï¼šisEmpty=trueï¼Œä½†åº”èƒ½ä¼°è®¡å°ºå¯¸å’Œè¯†åˆ«ç±»å‹
4. **æ¨¡ç³Šå›¾ç‰‡**ï¼šç½®ä¿¡åº¦åº”è¾ƒä½ï¼Œæç¤ºç”¨æˆ·ç¡®è®¤

---

## ğŸš€ å®æ–½ä¼˜å…ˆçº§

1. **P0ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰**ï¼š
   - æ›´æ–°åç«¯æ¥å£å’Œprompt
   - å®ç°æˆ¿é—´ç±»å‹è¯†åˆ«
   - å®ç°æˆ¿é—´é£æ ¼è¯†åˆ«

2. **P1ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰**ï¼š
   - å®ç°æˆ¿é—´å°ºå¯¸ä¼°è®¡
   - æ›´æ–°å‰ç«¯æ˜¾ç¤ºé€»è¾‘

3. **P2ï¼ˆä½ä¼˜å…ˆçº§ï¼‰**ï¼š
   - ä¼˜åŒ–prompt
   - æ·»åŠ ç½®ä¿¡åº¦é˜ˆå€¼å¤„ç†
   - æ·»åŠ ç”¨æˆ·ç¡®è®¤æœºåˆ¶
